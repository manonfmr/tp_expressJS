<!DOCTYPE html>
<html>
<head>
    <title>Connexion</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>

<div class="container">
    <h1 class="titre">Connexion</h1>
    <form class="form" action="/index.html" method="POST">
        <label class="label" for="login">Login:</label>
        <input id= "login" class="input" type="text" name="login"><br>
        <input id = "session" class="submit" type="submit" value="Submit" onclick="loadSession()">
    </form>
    <a class="link" href='Apropos.html'>A propos</a>
</div>

<script>
    
    function loadSession() {
        const xhttp = new XMLHttpRequest();
        const loginValue = document.getElementById('login').value;

        xhttp.onload = function() {
            const response = JSON.parse(this.responseText);
            if (response.success) {
                localStorage.setItem('login', response.login);
                window.location.href = '/index.html';
            } else {
                console.log('Ã‰chec de la connexion : Unauthorized');
                window.location.href = '/connexion.html';
            }
        };

        xhttp.open("POST", "./ajaxSession.html", true);
        xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");  
        xhttp.send("login=" + loginValue);
    }


</script>

</body>
</html>
